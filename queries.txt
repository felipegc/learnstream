
-- select * from product_order;
-- select * from ORDER_PRODUCT_RELATIONSHIP;
-- select * from product;


SELECT DISTINCT PRODUCT.* FROM PRODUCT_ORDER 
JOIN ORDER_PRODUCT_RELATIONSHIP ON ORDER_PRODUCT_RELATIONSHIP.ORDER_ID  = PRODUCT_ORDER.ID
JOIN PRODUCT ON ORDER_PRODUCT_RELATIONSHIP.PRODUCT_ID = PRODUCT.ID
JOIN CUSTOMER ON PRODUCT_ORDER.CUSTOMER_ID = CUSTOMER.ID
WHERE CUSTOMER.TIER = 2 AND PRODUCT_ORDER.ORDER_DATE >= '2021-02-01' AND PRODUCT_ORDER.ORDER_DATE <= '2021-04-01'

Select Product.* from Product where product.price = (select  MIN(Price) from product where category = 'Books' ) 

select SUM(PRODUCT.PRICE)
--PRODUCT_ORDER.ID as order_id,  PRODUCT_ORDER.order_date as order_date, PRODUCT.ID as product_id, PRODUCT.NAME as product_name, PRODUCT.PRICE, ---ORDER_PRODUCT_RELATIONSHIP.*
from PRODUCT_ORDER 
JOIN ORDER_PRODUCT_RELATIONSHIP ON ORDER_PRODUCT_RELATIONSHIP.ORDER_ID = PRODUCT_ORDER.ID
JOIN PRODUCT ON PRODUCT.ID = ORDER_PRODUCT_RELATIONSHIP.PRODUCT_ID
WHERE PRODUCT_ORDER.ORDER_DATE >= '2021-02-1' AND PRODUCT_ORDER.ORDER_DATE < '2021-03-1'

select AVG(PRODUCT.PRICE)
--PRODUCT_ORDER.ID as order_id,  PRODUCT_ORDER.order_date as order_date, PRODUCT.ID as product_id, PRODUCT.NAME as product_name, PRODUCT.PRICE, ---ORDER_PRODUCT_RELATIONSHIP.*
from PRODUCT_ORDER 
JOIN ORDER_PRODUCT_RELATIONSHIP ON ORDER_PRODUCT_RELATIONSHIP.ORDER_ID = PRODUCT_ORDER.ID
JOIN PRODUCT ON PRODUCT.ID = ORDER_PRODUCT_RELATIONSHIP.PRODUCT_ID
WHERE PRODUCT_ORDER.ORDER_DATE = '2021-03-15';

select AVG(PRODUCT.PRICE) as avg, SUM(PRODUCT.PRICE) as sum, max(PRODUCT.PRICE), min(PRODUCT.PRICE), count(DISTINCT PRODUCT.ID)
--PRODUCT_ORDER.ID as order_id,  PRODUCT_ORDER.order_date as order_date, PRODUCT.ID as product_id, PRODUCT.NAME as product_name, PRODUCT.PRICE, ---ORDER_PRODUCT_RELATIONSHIP.*
from PRODUCT_ORDER 
JOIN ORDER_PRODUCT_RELATIONSHIP ON ORDER_PRODUCT_RELATIONSHIP.ORDER_ID = PRODUCT_ORDER.ID
JOIN PRODUCT ON PRODUCT.ID = ORDER_PRODUCT_RELATIONSHIP.PRODUCT_ID
WHERE PRODUCT_ORDER.ORDER_DATE = '2021-03-15';

select Product_order.id, count(Product.id)  from Product_order Join order_product_relationship on Product_order.id = order_product_relationship.order_id 
join product on order_product_relationship.product_id = product.id group by product_order.id

